# Host & Network Pentesting: Network-Based Attacks

## Networking Fundamentals

- Every packet has Header and Payload: Header is where it contain where is it from and where it is to, what protocol is it (tell the computer how to process it), payload is the stuff inside including higher OSI layers Header

## Firewall Detection & IDS Evasion

**how to use Nmap to bypass Firewall and IDS**

- First, how to detect if there is a firewall (Open nmap -h manual and look at Firewall/IDS Evasion and spoofing session): Use sA scan, ACK scan will send an ACK packet, and it will tell us if it is open/unfiltered or filtered, if it is filtered, it is most likely there is a stateful firewall.

Fragmentation
- To Evade IDS and Firewall, a good skill is to fragment the packet
- `-f` flag to change the MTU, `--mtu` (Maximum traffic unit) to specific the mtu size, `nmap -Pn -sS -sV -F -f <IP>` vs `nmap -Pn -sS -sV -F <IP>` vs `nmap -Pn -sS -sV -F -f --mtu 8 <IP>`

Spoofing & Decoy (what hackersploit usually do)
- `-ttl and --data-lenth and -D (decoy ID)` is very useful to add variety
- `nmap -Pn -sS -sV -p445,3389 -f --data-length 200 -D <Decoy IP, usually we warm to set it from the gateway and broadcast since thats the least sus>`
- can change source port using the `-g` options like `-g 53`

Why disable DNS resolution using the `-n` option

1. âš¡ Speed:DNS lookups can significantly slow down scans â€” especially when scanning large IP ranges. Each IP might require a reverse DNS lookup, which introduces latency if DNS servers are slow or unresponsive.
2. ðŸ“‰ Avoiding Noise & Detection: DNS queries can trigger security alerts or get logged, which might alert admins to your presence. Disabling resolution makes the scan more stealthy.
3. ðŸ“µ Unavailable DNS: On internal networks or CTFs, reverse DNS might not even be configured. Waiting for responses that never come wastes time.
4. ðŸŽ¯ Accuracy & Clarity: Disabling DNS ensures Nmap just shows raw IP addresses instead of potentially misleading or incorrect hostnames.

## Network Enumeration

- Goal: service enumeration to gather additional, more specific/detailed info about hosts on a network and services running
- This phrase is to interact with the different protocols and ports open on the hosts, with the intent of eventually exploiting them

**SMB & NetBios Enum (Need further studies)**
- They are 2 different technologies, but they're related in the context of networking and file sharing on windows networks.
- NetBios is an API and a set of network protocols for providing communication services over a local network, primarily to allow app on different computers to find and interact with each other on a network.
- 3 Primary Services of NetBIOS: 1) Name Service: Allow computers to register, unregister and resolve names in the network 2) Datagram Service: Supports connectionless communication and broadcasting 3) Session Service: Supports connection-oriented communication for more reliable data transfers.
- NetBIOS typically uses ports 137(Name), 138(Datagram), 139(Session) over UDP and TCP
- SMBv1 might also be vulnerable to null session (anonymous login)

Tools to use for netbios: nbtscan, nmblookup, nmap script=nbstat

Tools to use for smb: nmap script=smb-protocols, script=smb-security-mode, smb-enum-users

- After enumerating the user, we can use hydra to bf the smb login
- Then we can use psexec.py to login


**SNMP**

- Used to monitor and manage networked devices such as routers, switches, printers, servers etc
- Allow network admin to query devices for status info, configure certain settings
- SNMP uses UDP, is an application layer protocol and involves 3 primary components:
  1) SNMP Manager: Responsible for querying and interacting with SNMP agents on networked devices
  2) SNMP Agent: Software running on the devices that responds to queries and sends traps
  3) Management Info Base(MIB): A gierarchical database that defines the structure fo data available through SNMP. Each piece of data has a unique Object Identifier(OID)








