# Vulnerability Assessment

Types of windows Vul
- Info disclosure
- Buffer overflows
- Remote Code Execution
- privilege escalation
- DOS

Frequently Exploited Win Native Services
- Microsoft IIS
- WebDAV
- SMB/CIFS
- RDP
- WinRM

**Vul scan with MSF**

**Ultra Useful MSF plugin: metasploit-autopwn**
To load it into msf use the following command
- wget the .rb file
- mv db_autopwn.rb /usr/share/metasploit-framewaork/plugins/
- Inside msfconsole: load db_autopwn (it only works when you got all the service info and host is in the postgredb database, so first do your nmap scans and load it in before using)
- There will be tons of exploit showing up, so be specific like: `db_autopwn -p -t -PI 445`
- `analyze` command will give you recommendations and `vulns` to detect vulnerabilities, it will show the CVEs


### Exploiting Microsoft IIS WebDAV

- IIS is basically a web server developed by microsoft for windows, typically run 80/443 without SSL/with SSL
- WebDav usually run on IIS or apache

**Exploitation Summary**
1. identify if the WebDAV has been configured to run on IIS web server
2. perform a brute-force attack on the server to obtain legitimate credentials
3. we can then authenticate with the WebDAV server and upload malicious .asp payload to get reverse shell
4. use `davtest` upload webshell eg: `davtest -auth username:password -url http://IP/webdav` to do a check to see what file can we upload
5. `cadaver` to upload files `cadaver http://IP/webdav`
6. kali comes with build in webshells at `/usr/share/webshells/`
7. in cadaver we say `put /usr/share/webshells/asp/webshell.asp`


### CVE-2019-0708 BlueKeep

- exploit RDP to gain remotely execute arbitrary code
- gain access to a chunk of kernel memory
- this module in msf will only work in x64 windows
- this module will need to set the target windows version manually

### WinRM (Pass-The-Hash-Attack) Named badblue in msf

- A technique that use to havest NTLM hashes or clear text passwords
- There are many Pass the hash attacks but will demonstrate: msf PsExec module and Crackmapexec
- after initial foothold: `load kiwi` to gain hash
- `crackmapexec smb <IP> -u <username> -p/-H <password or hash depending on the flag set before> -x <command to execute>`






